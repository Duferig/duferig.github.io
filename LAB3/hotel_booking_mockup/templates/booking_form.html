{% extends "layout.html" %}

{% block title %}Бронирование - {{ hotel.name }}{% endblock %}

{% block content %}
<div class="container my-5"> {# Добавили контейнер и отступы #}
    <nav aria-label="breadcrumb mb-4">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Главная</a></li>
        <li class="breadcrumb-item"><a href="{{ url_for('hotel_detail', hotel_id=hotel.id) }}">{{ hotel.name }}</a></li>
        <li class="breadcrumb-item active" aria-current="page">Бронирование</li>
      </ol>
    </nav>

    <h1 class="mb-4 display-5 page-title">Форма бронирования</h1>
    <h2 class="mb-4 text-muted fw-normal fs-4">Отель: {{ hotel.name }}</h2>

    <div class="row justify-content-center">
        <div class="col-lg-8">
            {# Показываем flash сообщения об ошибках валидации формы, если они есть #}
             {% with messages = get_flashed_messages(with_categories=true) %}
                 {% if messages %}
                     {% for category, message in messages %}
                         {% if category == 'warning' or category == 'danger' %} {# Показываем только предупреждения/ошибки #}
                             <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                                 {{ message }}
                                 <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                             </div>
                         {% endif %}
                     {% endfor %}
                 {% endif %}
             {% endwith %}

            <div class="card shadow-lg">
                <div class="card-body p-4 p-md-5">
                    <form action="{{ url_for('confirm_booking') }}" method="POST">
                        <input type="hidden" name="hotel_id" value="{{ hotel.id }}">

                        <h3 class="mb-4 form-section-title">Данные гостя</h3>
                        <div class="mb-4">
                            <label for="guest_name" class="form-label">Полное имя <span class="text-danger">*</span></label>
                            <input type="text" class="form-control form-control-lg" id="guest_name" name="guest_name" placeholder="Иванов Иван Иванович" required>
                        </div>
                        <div class="mb-4">
                            <label for="guest_email" class="form-label">Email адрес <span class="text-danger">*</span></label>
                            <input type="email" class="form-control form-control-lg" id="guest_email" name="guest_email" placeholder="example@mail.com" required>
                            <div id="emailHelp" class="form-text">Мы отправим подтверждение на этот адрес (симуляция).</div>
                        </div>

                        <h3 class="mb-4 form-section-title">Детали пребывания</h3>
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <label for="check_in_date" class="form-label">Дата заезда <span class="text-danger">*</span></label>
                                {# Используем переменную min_date_allowed, переданную из Python #}
                                <input type="date" class="form-control form-control-lg" id="check_in_date" name="check_in_date" 
                                       value="{{ default_check_in }}" 
                                       min="{{ min_date_allowed }}" 
                                       required>
                            </div>
                            <div class="col-md-6 mb-4">
                                <label for="nights" class="form-label">Количество ночей <span class="text-danger">*</span></label>
                                <input type="number" class="form-control form-control-lg" id="nights" name="nights" min="1" value="1" required>
                            </div>
                        </div>

                        <hr class="my-4">

                         <p class="small text-muted mb-4"><span class="text-danger">*</span> - Обязательные поля</p>

                        <div class="d-grid">
                             <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-check2-circle"></i> Подтвердить бронирование
                            </button>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div> {# Конец .container #}
{% endblock %}